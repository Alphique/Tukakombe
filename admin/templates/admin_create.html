{% extends "blog_base.html" %}
{% block title %}Admin - Create & Manage Blogs{% endblock %}

{% block content %}
<div class="admin-dashboard">
    <!-- Header with Stats -->
    <header class="dashboard-header">
        <div class="header-main">
            <div class="header-title">
                <h1>
                    <span class="title-icon">üìù</span>
                    Blog Management Center
                </h1>
                <p class="subtitle">Create, edit, and manage blog content with real-time preview</p>
            </div>
            <div class="user-status">
                <span class="user-avatar">üë§</span>
                <div class="user-info">
                    <span class="user-name">{{ session.get('role')|capitalize }} Admin</span>
                    <span class="user-actions">
                        <button class="quick-action" onclick="location.href='{{ url_for('admin.dashboard') }}'">‚Üê Dashboard</button>
                    </span>
                </div>
            </div>
        </div>
        
        <!-- Quick Stats -->
        <div class="stats-grid">
            <div class="stat-card stat-total">
                <div class="stat-icon">üìä</div>
                <div class="stat-content">
                    <span class="stat-number">{{ blogs|length if blogs else 0 }}</span>
                    <span class="stat-label">Total Blogs</span>
                </div>
                <div class="stat-trend">+2 this week</div>
            </div>
            
            <div class="stat-card stat-comments">
                <div class="stat-icon">üí¨</div>
                <div class="stat-content">
                    <span class="stat-number">{{ comments|length if comments else 0 }}</span>
                    <span class="stat-label">Total Comments</span>
                </div>
                <div class="stat-trend">+5 today</div>
            </div>
            
            <div class="stat-card stat-drafts">
                <div class="stat-icon">üìÑ</div>
                <div class="stat-content">
                    <span class="stat-number">3</span>
                    <span class="stat-label">Drafts</span>
                </div>
                <div class="stat-trend">2 pending review</div>
            </div>
            
            <div class="stat-card stat-traffic">
                <div class="stat-icon">üìà</div>
                <div class="stat-content">
                    <span class="stat-number">1.2k</span>
                    <span class="stat-label">Monthly Views</span>
                </div>
                <div class="stat-trend">‚Üë 12%</div>
            </div>
        </div>
    </header>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
      <div class="alerts-container">
        {% for category, message in messages %}
        <div class="alert alert-{{ category }}">
          <div class="alert-icon">
            {% if category == 'success' %}‚úÖ
            {% elif category == 'error' %}‚ùå
            {% elif category == 'warning' %}‚ö†Ô∏è
            {% else %}‚ÑπÔ∏è{% endif %}
          </div>
          <div class="alert-content">
            <strong>{{ category|capitalize }}!</strong> {{ message }}
          </div>
          <button class="alert-close" onclick="this.parentElement.remove()">√ó</button>
        </div>
        {% endfor %}
      </div>
      {% endif %}
    {% endwith %}

    <!-- Main Content Area -->
    <div class="main-content">
        <!-- Left Column: Create Blog with Live Preview -->
        <div class="left-column">
            <div class="create-blog-card">
                <div class="card-header">
                    <div class="header-tabs">
                        <button class="tab-btn active" onclick="switchTab('create')">Create New</button>
                        <button class="tab-btn" onclick="switchTab('drafts')">Drafts (3)</button>
                        <button class="tab-btn" onclick="switchTab('scheduled')">Scheduled</button>
                    </div>
                    <div class="header-actions">
                        <button class="btn-icon" onclick="togglePreview()" title="Toggle Preview">
                            üëÅÔ∏è
                        </button>
                        <button class="btn-icon" onclick="saveDraft()" title="Save as Draft">
                            üíæ
                        </button>
                    </div>
                </div>
                
                <div class="card-body">
                    <form id="createBlogForm" method="POST" action="{{ url_for('admin.create_blog') }}" enctype="multipart/form-data">
                        <div class="form-section">
                            <div class="form-header">
                                <h3>Blog Information</h3>
                                <span class="form-helper">Fill in the details below to create a new blog post</span>
                            </div>
                            
                            <!-- Title with Character Counter -->
                            <div class="input-group">
                                <label class="input-label">
                                    <span>Blog Title</span>
                                    <span class="char-counter" id="titleCounter">0/100</span>
                                </label>
                                <input type="text" 
                                       name="title" 
                                       class="input-field" 
                                       placeholder="Enter an engaging title..."
                                       maxlength="100"
                                       oninput="updateCounter('titleCounter', this, 100)"
                                       required>
                            </div>
                            
                            <!-- Slug Generator -->
                            <div class="input-group">
                                <label class="input-label">
                                    <span>URL Slug</span>
                                    <button type="button" class="btn-generate" onclick="generateSlug()">Generate</button>
                                </label>
                                <input type="text" 
                                       name="slug" 
                                       class="input-field" 
                                       placeholder="auto-generated-from-title"
                                       id="slugField"
                                       readonly>
                            </div>
                            
                            <!-- Category Selection -->
                            <div class="input-group">
                                <label class="input-label">Category</label>
                                <div class="category-select">
                                    {% set categories = ['Technology', 'Business', 'Lifestyle', 'Education', 'Finance', 'Health'] %}
                                    {% for category in categories %}
                                    <label class="category-chip">
                                        <input type="checkbox" name="categories" value="{{ category }}">
                                        <span>{{ category }}</span>
                                    </label>
                                    {% endfor %}
                                </div>
                            </div>
                            
                            <!-- Content Editor -->
                            <div class="input-group">
                                <label class="input-label">
                                    <span>Content</span>
                                    <span class="char-counter" id="contentCounter">0/5000</span>
                                </label>
                                <div class="editor-toolbar">
                                    <button type="button" class="editor-btn" onclick="formatText('bold')"><b>B</b></button>
                                    <button type="button" class="editor-btn" onclick="formatText('italic')"><i>I</i></button>
                                    <button type="button" class="editor-btn" onclick="formatText('underline')"><u>U</u></button>
                                    <button type="button" class="editor-btn" onclick="formatText('link')">üîó</button>
                                    <button type="button" class="editor-btn" onclick="formatText('image')">üñºÔ∏è</button>
                                    <button type="button" class="editor-btn" onclick="formatText('code')">{ }</button>
                                    <div class="toolbar-divider"></div>
                                    <button type="button" class="editor-btn" onclick="formatText('h1')">H1</button>
                                    <button type="button" class="editor-btn" onclick="formatText('h2')">H2</button>
                                    <button type="button" class="editor-btn" onclick="formatText('h3')">H3</button>
                                </div>
                                <textarea name="content" 
                                          id="contentEditor"
                                          class="editor-textarea"
                                          rows="15"
                                          placeholder="Start writing your amazing content here..."
                                          oninput="updateCounter('contentCounter', this, 5000)"
                                          required></textarea>
                            </div>
                            
                            <!-- Featured Image -->
                            <div class="input-group">
                                <label class="input-label">Featured Image</label>
                                <div class="image-uploader" id="imageUploader">
                                    <input type="file" 
                                           name="image" 
                                           accept="image/*" 
                                           id="imageInput"
                                           onchange="handleImageUpload(event)">
                                    <div class="upload-placeholder">
                                        <div class="upload-icon">üìÅ</div>
                                        <div class="upload-text">
                                            <strong>Click to upload</strong>
                                            <span>or drag and drop</span>
                                        </div>
                                        <div class="upload-subtext">PNG, JPG, GIF up to 5MB</div>
                                    </div>
                                    <div class="image-preview" id="imagePreview">
                                        <img id="uploadedImage" src="" alt="Preview">
                                        <div class="preview-overlay">
                                            <button type="button" class="btn-icon" onclick="removeImage()">üóëÔ∏è</button>
                                            <button type="button" class="btn-icon" onclick="openImageEditor()">‚úèÔ∏è</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- SEO Settings -->
                            <div class="collapsible-section">
                                <button type="button" class="collapsible-header" onclick="toggleCollapse('seoSettings')">
                                    <span>SEO Settings</span>
                                    <span class="collapse-icon">‚ñº</span>
                                </button>
                                <div class="collapsible-content" id="seoSettings">
                                    <div class="input-group">
                                        <label class="input-label">Meta Description</label>
                                        <textarea class="input-field" 
                                                  name="meta_description" 
                                                  rows="3"
                                                  placeholder="Brief description for search engines..."
                                                  maxlength="160"></textarea>
                                        <div class="form-helper">Optimal length: 150-160 characters</div>
                                    </div>
                                    
                                    <div class="input-group">
                                        <label class="input-label">Keywords</label>
                                        <input type="text" 
                                               class="input-field" 
                                               name="keywords"
                                               placeholder="blog, tutorial, tips, ...">
                                        <div class="form-helper">Separate with commas</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Publish Options -->
                            <div class="form-section">
                                <div class="form-header">
                                    <h3>Publish Options</h3>
                                </div>
                                
                                <div class="publish-options">
                                    <label class="option-item">
                                        <input type="radio" name="status" value="published" checked>
                                        <span class="option-content">
                                            <strong>Publish Immediately</strong>
                                            <span>Make this blog live right away</span>
                                        </span>
                                    </label>
                                    
                                    <label class="option-item">
                                        <input type="radio" name="status" value="draft">
                                        <span class="option-content">
                                            <strong>Save as Draft</strong>
                                            <span>Save for later editing</span>
                                        </span>
                                    </label>
                                    
                                    <label class="option-item">
                                        <input type="radio" name="status" value="scheduled">
                                        <span class="option-content">
                                            <strong>Schedule Publication</strong>
                                            <span>
                                                <input type="datetime-local" 
                                                       name="scheduled_date" 
                                                       class="datetime-input"
                                                       disabled>
                                            </span>
                                        </span>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Form Actions -->
                            <div class="form-actions">
                                <button type="submit" class="btn-primary btn-publish">
                                    <span class="btn-icon">üöÄ</span>
                                    <span class="btn-text">Publish Blog</span>
                                </button>
                                <button type="button" class="btn-secondary" onclick="saveDraft()">
                                    <span class="btn-icon">üíæ</span>
                                    <span class="btn-text">Save Draft</span>
                                </button>
                                <button type="reset" class="btn-outline">
                                    <span class="btn-icon">‚Ü∫</span>
                                    <span class="btn-text">Clear All</span>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Right Column: Preview & Management -->
        <div class="right-column">
            <!-- Live Preview -->
            <div class="preview-card">
                <div class="card-header">
                    <h3>Live Preview</h3>
                    <div class="preview-actions">
                        <button class="btn-icon-sm" onclick="refreshPreview()">üîÑ</button>
                        <button class="btn-icon-sm" onclick="togglePreviewSize()">‚ÜîÔ∏è</button>
                    </div>
                </div>
                <div class="preview-container" id="previewContainer">
                    <div class="preview-header">
                        <div class="preview-title" id="previewTitle">Your Blog Title Here</div>
                        <div class="preview-meta">
                            <span>Published: Just now</span>
                            <span>By: Admin</span>
                        </div>
                    </div>
                    <div class="preview-image" id="previewImage">
                        <div class="image-placeholder">
                                            <span>üì∑ Featured Image Preview</span>
                                        </div>
                                    </div>
                                    <div class="preview-content" id="previewContent">
                                        <p>Your blog content will appear here in real-time as you type...</p>
                                        <p>Formatting, images, and all styling will be previewed.</p>
                                    </div>
                                    <div class="preview-footer">
                                        <div class="preview-tags">
                                            <span class="tag">Blog</span>
                                            <span class="tag">Preview</span>
                                        </div>
                                        <div class="preview-stats">
                                            <span>üëÅÔ∏è 0 views</span>
                                            <span>üí¨ 0 comments</span>
                                            <span>‚≠ê 0 likes</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
            
            <!-- Quick Stats & Insights -->
            <div class="insights-card">
                <div class="card-header">
                    <h3>Performance Insights</h3>
                    <select class="period-select">
                        <option>Last 7 days</option>
                        <option>Last 30 days</option>
                        <option>Last quarter</option>
                    </select>
                </div>
                <div class="insights-grid">
                    <div class="insight-item">
                        <div class="insight-icon" style="background: var(--lime-dark)">üëÅÔ∏è</div>
                        <div class="insight-content">
                            <span class="insight-value">1,245</span>
                            <span class="insight-label">Total Views</span>
                        </div>
                        <div class="insight-trend up">+12%</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-icon" style="background: var(--navy-light)">üí¨</div>
                        <div class="insight-content">
                            <span class="insight-value">48</span>
                            <span class="insight-label">Comments</span>
                        </div>
                        <div class="insight-trend up">+8%</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-icon" style="background: #e83e8c">‚ù§Ô∏è</div>
                        <div class="insight-content">
                            <span class="insight-value">156</span>
                            <span class="insight-label">Likes</span>
                        </div>
                        <div class="insight-trend down">-3%</div>
                    </div>
                    <div class="insight-item">
                        <div class="insight-icon" style="background: #20c997">üìà</div>
                        <div class="insight-content">
                            <span class="insight-value">2.4m</span>
                            <span class="insight-label">Avg. Read Time</span>
                        </div>
                        <div class="insight-trend up">+15%</div>
                    </div>
                </div>
            </div>
            
            <!-- Quick Actions -->
            <div class="quick-actions-card">
                <h3>Quick Actions</h3>
                <div class="actions-grid">
                    <button class="action-btn" onclick="location.href='{{ url_for('admin.dashboard') }}'">
                        <span class="action-icon">üìä</span>
                        <span class="action-text">Dashboard</span>
                    </button>
                    <button class="action-btn" onclick="exportContent()">
                        <span class="action-icon">üì§</span>
                        <span class="action-text">Export</span>
                    </button>
                    <button class="action-btn" onclick="showAnalytics()">
                        <span class="action-icon">üìà</span>
                        <span class="action-text">Analytics</span>
                    </button>
                    <button class="action-btn" onclick="manageUsers()">
                        <span class="action-icon">üë•</span>
                        <span class="action-text">Users</span>
                    </button>
                    <button class="action-btn" onclick="openSettings()">
                        <span class="action-icon">‚öôÔ∏è</span>
                        <span class="action-text">Settings</span>
                    </button>
                    <button class="action-btn" onclick="showHelp()">
                        <span class="action-icon">‚ùì</span>
                        <span class="action-text">Help</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bottom Section: Blog Management -->
    <div class="management-section">
        <div class="section-header">
            <h2>Blog Management</h2>
            <div class="section-actions">
                <div class="search-box">
                    <input type="text" 
                           placeholder="Search blogs..." 
                           class="search-input"
                           oninput="searchBlogs(this.value)">
                    <span class="search-icon">üîç</span>
                </div>
                <select class="filter-select" onchange="filterBlogs(this.value)">
                    <option value="all">All Blogs</option>
                    <option value="published">Published</option>
                    <option value="draft">Drafts</option>
                    <option value="scheduled">Scheduled</option>
                </select>
            </div>
        </div>
        
        <div class="blogs-table-container">
            <table class="blogs-table">
                <thead>
                    <tr>
                        <th>
                            <label class="checkbox-cell">
                                <input type="checkbox" id="selectAll">
                                <span class="checkmark"></span>
                            </label>
                        </th>
                        <th>Blog Title</th>
                        <th>Status</th>
                        <th>Author</th>
                        <th>Date</th>
                        <th>Views</th>
                        <th>Comments</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for blog in blogs %}
                    <tr class="blog-row" data-status="{{ blog.status if blog.status else 'published' }}">
                        <td>
                            <label class="checkbox-cell">
                                <input type="checkbox" class="blog-checkbox" value="{{ blog['id'] }}">
                                <span class="checkmark"></span>
                            </label>
                        </td>
                        <td>
                            <div class="blog-title-cell">
                                <div class="blog-thumbnail">
                                    {% if blog.image %}
                                    <img src="{{ blog.image }}" alt="Thumbnail">
                                    {% else %}
                                    <div class="thumbnail-placeholder">üìù</div>
                                    {% endif %}
                                </div>
                                <div class="blog-info">
                                    <strong>{{ blog['title'] }}</strong>
                                    <span class="blog-excerpt">{{ blog['content'][:60] }}...</span>
                                </div>
                            </div>
                        </td>
                        <td>
                            <span class="status-badge status-{{ blog.status if blog.status else 'published' }}">
                                {{ blog.status|capitalize if blog.status else 'Published' }}
                            </span>
                        </td>
                        <td>Admin</td>
                        <td>{{ blog['created_at'] }}</td>
                        <td>1.2k</td>
                        <td>{{ blog['comments']|length if blog['comments'] else 0 }}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-action btn-edit" 
                                        onclick="location.href='{{ url_for('admin.edit_blog', blog_id=blog['id']) }}'">
                                    ‚úèÔ∏è
                                </button>
                                <button class="btn-action btn-delete" 
                                        onclick="deleteBlog('{{ blog['id'] }}')">
                                    üóëÔ∏è
                                </button>
                                <button class="btn-action btn-more" 
                                        onclick="showMoreActions('{{ blog['id'] }}')">
                                    ‚ãÆ
                                </button>
                            </div>
                        </td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="8" class="empty-table">
                            <div class="empty-state">
                                <span class="empty-icon">üìÑ</span>
                                <h3>No blogs found</h3>
                                <p>Create your first blog to get started</p>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <!-- Bulk Actions -->
        <div class="bulk-actions" id="bulkActions">
            <div class="bulk-info">
                <span id="selectedCount">0</span> blogs selected
            </div>
            <div class="bulk-buttons">
                <button class="btn-outline" onclick="bulkPublish()">üì§ Publish</button>
                <button class="btn-outline" onclick="bulkDraft()">üíæ Draft</button>
                <button class="btn-danger" onclick="bulkDelete()">üóëÔ∏è Delete</button>
            </div>
        </div>
    </div>
</div>

<!-- Image Editor Modal -->
<div id="imageEditorModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Edit Image</h3>
            <button class="modal-close" onclick="closeModal('imageEditorModal')">√ó</button>
        </div>
        <div class="modal-body">
            <div class="image-editor">
                <div class="editor-preview">
                    <img id="editImage" src="" alt="Edit">
                </div>
                <div class="editor-controls">
                    <div class="control-group">
                        <label>Crop</label>
                        <input type="range" min="0" max="100" value="100" id="cropSlider">
                    </div>
                    <div class="control-group">
                        <label>Brightness</label>
                        <input type="range" min="0" max="200" value="100" id="brightnessSlider">
                    </div>
                    <div class="control-group">
                        <label>Contrast</label>
                        <input type="range" min="0" max="200" value="100" id="contrastSlider">
                    </div>
                    <div class="control-group">
                        <label>Filter</label>
                        <select id="filterSelect">
                            <option value="none">None</option>
                            <option value="grayscale">Grayscale</option>
                            <option value="sepia">Sepia</option>
                            <option value="vintage">Vintage</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn-secondary" onclick="closeModal('imageEditorModal')">Cancel</button>
            <button class="btn-primary" onclick="applyImageEdits()">Apply Changes</button>
        </div>
    </div>
</div>

<!-- More Actions Dropdown -->
<div class="dropdown-menu" id="moreActionsMenu">
    <button onclick="viewBlog()">üëÅÔ∏è View Blog</button>
    <button onclick="shareBlog()">üì§ Share</button>
    <button onclick="duplicateBlog()">üìã Duplicate</button>
    <button onclick="exportBlog()">üìÑ Export</button>
    <hr>
    <button onclick="viewAnalytics()">üìà Analytics</button>
    <button onclick="viewComments()">üí¨ Comments</button>
</div>

<!-- Success Toast -->
<div class="toast" id="successToast">
    <div class="toast-icon">‚úÖ</div>
    <div class="toast-content">
        <strong>Success!</strong>
        <span id="toastMessage">Action completed successfully</span>
    </div>
    <button class="toast-close" onclick="hideToast()">√ó</button>
</div>

<style>
/* ====== Base Styles ====== */
.admin-dashboard {
    padding: 2rem;
    max-width: 1600px;
    margin: 0 auto;
    background: linear-gradient(135deg, var(--navy-dark) 0%, var(--navy) 100%);
    min-height: 100vh;
}

/* ====== Header & Stats ====== */
.dashboard-header {
    background: var(--navy);
    border-radius: var(--radius-xl);
    padding: 2rem;
    margin-bottom: 2rem;
    border: 1px solid var(--navy-light);
    box-shadow: var(--shadow-lg);
}

.header-main {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 2rem;
}

.header-title h1 {
    display: flex;
    align-items: center;
    gap: 1rem;
    font-size: 2.5rem;
    color: var(--lime-light);
    margin: 0 0 0.5rem 0;
    background: linear-gradient(135deg, var(--lime) 0%, var(--lime-light) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.title-icon {
    font-size: 2.5rem;
}

.subtitle {
    color: var(--text-muted);
    font-size: 1.1rem;
    margin: 0;
}

.user-status {
    display: flex;
    align-items: center;
    gap: 1rem;
    background: rgba(255, 255, 255, 0.05);
    padding: 1rem 1.5rem;
    border-radius: var(--radius-lg);
    border: 1px solid var(--navy-light);
}

.user-avatar {
    font-size: 2rem;
    background: var(--lime);
    color: var(--navy-dark);
    width: 48px;
    height: 48px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.user-info {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

.user-name {
    color: var(--text-light);
    font-weight: 600;
}

.quick-action {
    background: var(--navy-light);
    color: var(--lime);
    border: 1px solid var(--navy-light);
    padding: 0.375rem 0.75rem;
    border-radius: var(--radius-sm);
    font-size: 0.875rem;
    cursor: pointer;
    transition: var(--transition);
}

.quick-action:hover {
    background: var(--lime);
    color: var(--navy-dark);
}

/* Stats Grid */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
}

.stat-card {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.02) 100%);
    border-radius: var(--radius-lg);
    padding: 1.5rem;
    display: flex;
    align-items: center;
    gap: 1rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: var(--transition);
}

.stat-card:hover {
    transform: translateY(-5px);
    border-color: var(--lime);
    box-shadow: var(--shadow-md);
}

.stat-icon {
    font-size: 2rem;
    width: 60px;
    height: 60px;
    background: var(--navy-light);
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
}

.stat-content {
    flex: 1;
}

.stat-number {
    display: block;
    font-size: 2rem;
    font-weight: 700;
    color: var(--lime-light);
    line-height: 1;
}

.stat-label {
    display: block;
    color: var(--text-muted);
    font-size: 0.9rem;
    margin-top: 0.25rem;
}

.stat-trend {
    font-size: 0.875rem;
    font-weight: 600;
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    background: rgba(162, 210, 66, 0.1);
    color: var(--lime);
}

.stat-trend.up { background: rgba(40, 167, 69, 0.1); color: #28a745; }
.stat-trend.down { background: rgba(220, 53, 69, 0.1); color: #dc3545; }

/* ====== Alerts ====== */
.alerts-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 1000;
    max-width: 400px;
    width: 100%;
}

.alert {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem 1.5rem;
    margin-bottom: 1rem;
    border-radius: var(--radius-lg);
    border-left: 4px solid;
    animation: slideInRight 0.3s ease;
    backdrop-filter: blur(10px);
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.alert-success { border-color: var(--lime); }
.alert-error { border-color: #dc3545; }
.alert-warning { border-color: #ffc107; }
.alert-info { border-color: #17a2b8; }

.alert-icon {
    font-size: 1.5rem;
}

.alert-content {
    flex: 1;
    color: var(--text-light);
}

.alert-close {
    background: none;
    border: none;
    color: var(--text-muted);
    font-size: 1.5rem;
    cursor: pointer;
    padding: 0;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
}

.alert-close:hover {
    background: rgba(255, 255, 255, 0.1);
}

/* ====== Main Content Layout ====== */
.main-content {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 2rem;
    margin-bottom: 3rem;
}

@media (max-width: 1200px) {
    .main-content {
        grid-template-columns: 1fr;
    }
}

/* ====== Create Blog Card ====== */
.create-blog-card {
    background: var(--navy);
    border-radius: var(--radius-xl);
    overflow: hidden;
    border: 1px solid var(--navy-light);
    box-shadow: var(--shadow-lg);
}

.card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.5rem 2rem;
    background: rgba(0, 0, 0, 0.3);
    border-bottom: 1px solid var(--navy-light);
}

.header-tabs {
    display: flex;
    gap: 0.5rem;
}

.tab-btn {
    padding: 0.75rem 1.5rem;
    background: transparent;
    border: 1px solid var(--navy-light);
    color: var(--text-muted);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: var(--transition);
    font-weight: 500;
}

.tab-btn.active {
    background: var(--lime);
    color: var(--navy-dark);
    border-color: var(--lime);
}

.tab-btn:hover:not(.active) {
    background: var(--navy-light);
    color: var(--text-light);
}

/* ====== Form Styles ====== */
.form-section {
    padding: 2rem;
}

.form-header {
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--navy-light);
}

.form-header h3 {
    color: var(--lime-light);
    margin: 0 0 0.5rem 0;
    font-size: 1.5rem;
}

.form-helper {
    color: var(--text-muted);
    font-size: 0.9rem;
}

.input-group {
    margin-bottom: 1.5rem;
}

.input-label {
    display: flex;
    justify-content: space-between;
    align-items: center;
    color: var(--text-light);
    font-weight: 500;
    margin-bottom: 0.5rem;
    font-size: 0.95rem;
}

.char-counter {
    color: var(--text-muted);
    font-size: 0.85rem;
    font-weight: normal;
}

.input-field {
    width: 100%;
    padding: 1rem;
    background: var(--navy-dark);
    border: 2px solid var(--navy-light);
    border-radius: var(--radius-md);
    color: var(--text-light);
    font-size: 1rem;
    transition: var(--transition);
}

.input-field:focus {
    outline: none;
    border-color: var(--lime);
    box-shadow: 0 0 0 3px rgba(162, 210, 66, 0.3);
}

.btn-generate {
    background: var(--navy-light);
    color: var(--lime);
    border: 1px solid var(--navy-light);
    padding: 0.375rem 0.75rem;
    border-radius: var(--radius-sm);
    font-size: 0.875rem;
    cursor: pointer;
    transition: var(--transition);
}

.btn-generate:hover {
    background: var(--lime);
    color: var(--navy-dark);
}

/* Category Chips */
.category-select {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-top: 0.5rem;
}

.category-chip {
    display: inline-flex;
    align-items: center;
    padding: 0.5rem 1rem;
    background: var(--navy-dark);
    border: 2px solid var(--navy-light);
    border-radius: 50px;
    cursor: pointer;
    transition: var(--transition);
}

.category-chip input {
    display: none;
}

.category-chip span {
    color: var(--text-muted);
    font-size: 0.9rem;
}

.category-chip:hover {
    border-color: var(--lime);
}

.category-chip input:checked + span {
    color: var(--lime);
    font-weight: 600;
}

.category-chip input:checked ~ .category-chip {
    border-color: var(--lime);
    background: rgba(162, 210, 66, 0.1);
}

/* Editor */
.editor-toolbar {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    padding: 0.75rem;
    background: var(--navy-dark);
    border: 1px solid var(--navy-light);
    border-radius: var(--radius-md) var(--radius-md) 0 0;
    border-bottom: none;
}

.editor-btn {
    background: transparent;
    border: 1px solid var(--navy-light);
    color: var(--text-muted);
    width: 36px;
    height: 36px;
    border-radius: var(--radius-sm);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: var(--transition);
    font-family: inherit;
}

.editor-btn:hover {
    background: var(--navy-light);
    color: var(--text-light);
}

.toolbar-divider {
    width: 1px;
    background: var(--navy-light);
    margin: 0 0.25rem;
}

.editor-textarea {
    width: 100%;
    padding: 1rem;
    background: var(--navy-dark);
    border: 1px solid var(--navy-light);
    border-radius: 0 0 var(--radius-md) var(--radius-md);
    color: var(--text-light);
    font-size: 1rem;
    line-height: 1.6;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    resize: vertical;
    min-height: 300px;
}

/* Image Uploader */
.image-uploader {
    border: 3px dashed var(--navy-light);
    border-radius: var(--radius-lg);
    padding: 3rem 2rem;
    text-align: center;
    cursor: pointer;
    position: relative;
    overflow: hidden;
    transition: var(--transition);
}

.image-uploader:hover {
    border-color: var(--lime);
    background: rgba(162, 210, 66, 0.05);
}

.image-uploader input[type="file"] {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    opacity: 0;
    cursor: pointer;
}

.upload-placeholder {
    pointer-events: none;
}

.upload-icon {
    font-size: 3rem;
    color: var(--navy-light);
    margin-bottom: 1rem;
}

.upload-text {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
    margin-bottom: 0.5rem;
}

.upload-text strong {
    color: var(--text-light);
    font-size: 1.1rem;
}

.upload-text span {
    color: var(--text-muted);
    font-size: 0.9rem;
}

.upload-subtext {
    color: var(--text-muted);
    font-size: 0.85rem;
}

.image-preview {
    display: none;
    margin-top: 1rem;
    position: relative;
    border-radius: var(--radius-md);
    overflow: hidden;
}

.image-preview img {
    width: 100%;
    max-height: 300px;
    object-fit: cover;
}

.preview-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1rem;
    opacity: 0;
    transition: var(--transition);
}

.image-preview:hover .preview-overlay {
    opacity: 1;
}

/* Publish Options */
.publish-options {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.option-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: var(--navy-dark);
    border: 2px solid var(--navy-light);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: var(--transition);
}

.option-item:hover {
    border-color: var(--lime);
    background: rgba(162, 210, 66, 0.05);
}

.option-item input[type="radio"] {
    width: 20px;
    height: 20px;
}

.option-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

.option-content strong {
    color: var(--text-light);
}

.option-content span {
    color: var(--text-muted);
    font-size: 0.9rem;
}

.datetime-input {
    width: 200px;
    padding: 0.5rem;
    background: var(--navy);
    border: 1px solid var(--navy-light);
    border-radius: var(--radius-sm);
    color: var(--text-light);
}

/* Form Actions */
.form-actions {
    display: flex;
    gap: 1rem;
    margin-top: 2rem;
    padding-top: 2rem;
    border-top: 1px solid var(--navy-light);
}

.btn-primary, .btn-secondary, .btn-outline {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem 2rem;
    border-radius: var(--radius-lg);
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
    border: 2px solid;
    font-size: 1rem;
}

.btn-primary {
    background: var(--lime);
    color: var(--navy-dark);
    border-color: var(--lime);
    flex: 2;
}

.btn-primary:hover {
    background: var(--lime-light);
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
}

.btn-secondary {
    background: var(--navy-light);
    color: var(--text-light);
    border-color: var(--navy-light);
    flex: 1;
}

.btn-secondary:hover {
    background: var(--navy);
    border-color: var(--lime);
}

.btn-outline {
    background: transparent;
    color: var(--text-muted);
    border-color: var(--navy-light);
    flex: 1;
}

.btn-outline:hover {
    color: var(--text-light);
    border-color: var(--lime);
}

.btn-icon {
    background: transparent;
    border: 1px solid var(--navy-light);
    color: var(--text-light);
    width: 40px;
    height: 40px;
    border-radius: var(--radius-md);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: var(--transition);
}

.btn-icon:hover {
    background: var(--navy-light);
    border-color: var(--lime);
}

/* ====== Right Column Cards ====== */
.right-column {
    display: flex;
    flex-direction: column;
    gap: 2rem;
}

.preview-card, .insights-card, .quick-actions-card {
    background: var(--navy);
    border-radius: var(--radius-xl);
    border: 1px solid var(--navy-light);
    overflow: hidden;
}

.preview-container {
    padding: 2rem;
    background: white;
    color: #333;
    border-radius: var(--radius-lg);
    margin: 1rem;
    min-height: 400px;
    max-height: 500px;
    overflow-y: auto;
}

.preview-header {
    margin-bottom: 1.5rem;
}

.preview-title {
    font-size: 1.75rem;
    font-weight: 700;
    color: #1a2a40;
    margin-bottom: 0.5rem;
    line-height: 1.3;
}

.preview-meta {
    display: flex;
    gap: 1rem;
    color: #666;
    font-size: 0.9rem;
}

.preview-image {
    margin-bottom: 1.5rem;
}

.image-placeholder {
    background: #f5f5f5;
    border: 2px dashed #ddd;
    border-radius: var(--radius-md);
    padding: 3rem;
    text-align: center;
    color: #999;
}

.preview-content {
    line-height: 1.8;
    margin-bottom: 1.5rem;
}

.preview-footer {
    padding-top: 1.5rem;
    border-top: 1px solid #eee;
}

.preview-tags {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
}

.tag {
    background: #e9ecef;
    color: #495057;
    padding: 0.25rem 0.75rem;
    border-radius: 50px;
    font-size: 0.85rem;
}

.preview-stats {
    display: flex;
    gap: 1rem;
    color: #666;
    font-size: 0.9rem;
}

/* Insights Card */
.insights-grid {
    padding: 1.5rem;
    display: grid;
    gap: 1rem;
}

.insight-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: var(--navy-dark);
    border-radius: var(--radius-md);
    border: 1px solid var(--navy-light);
}

.insight-icon {
    width: 48px;
    height: 48px;
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
}

.insight-content {
    flex: 1;
}

.insight-value {
    display: block;
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-light);
    line-height: 1;
}

.insight-label {
    display: block;
    color: var(--text-muted);
    font-size: 0.9rem;
    margin-top: 0.25rem;
}

.insight-trend {
    font-size: 0.875rem;
    font-weight: 600;
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
}

/* Quick Actions */
.actions-grid {
    padding: 1.5rem;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
}

.action-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    padding: 1.5rem 1rem;
    background: var(--navy-dark);
    border: 1px solid var(--navy-light);
    border-radius: var(--radius-lg);
    cursor: pointer;
    transition: var(--transition);
}

.action-btn:hover {
    background: var(--navy-light);
    border-color: var(--lime);
    transform: translateY(-2px);
}

.action-icon {
    font-size: 1.5rem;
}

.action-text {
    color: var(--text-light);
    font-size: 0.9rem;
    font-weight: 500;
}

/* ====== Management Section ====== */
.management-section {
    background: var(--navy);
    border-radius: var(--radius-xl);
    border: 1px solid var(--navy-light);
    padding: 2rem;
    margin-top: 2rem;
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
}

.section-header h2 {
    color: var(--lime-light);
    margin: 0;
    font-size: 1.75rem;
}

.section-actions {
    display: flex;
    gap: 1rem;
    align-items: center;
}

.search-box {
    position: relative;
    width: 300px;
}

.search-input {
    width: 100%;
    padding: 0.875rem 1rem 0.875rem 3rem;
    background: var(--navy-dark);
    border: 2px solid var(--navy-light);
    border-radius: var(--radius-md);
    color: var(--text-light);
}

.search-icon {
    position: absolute;
    left: 1rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-muted);
}

.filter-select {
    padding: 0.875rem 1rem;
    background: var(--navy-dark);
    border: 2px solid var(--navy-light);
    border-radius: var(--radius-md);
    color: var(--text-light);
    min-width: 150px;
}

/* Blogs Table */
.blogs-table-container {
    overflow-x: auto;
    border-radius: var(--radius-lg);
    border: 1px solid var(--navy-light);
}

.blogs-table {
    width: 100%;
    border-collapse: collapse;
    background: var(--navy-dark);
}

.blogs-table th {
    padding: 1rem;
    text-align: left;
    color: var(--text-light);
    font-weight: 600;
    border-bottom: 2px solid var(--navy-light);
    background: rgba(0, 0, 0, 0.3);
}

.blogs-table td {
    padding: 1rem;
    border-bottom: 1px solid var(--navy-light);
    color: var(--text-light);
}

.blog-row:hover {
    background: rgba(162, 210, 66, 0.05);
}

.checkbox-cell {
    display: block;
    position: relative;
    cursor: pointer;
    width: 20px;
    height: 20px;
}

.checkbox-cell input {
    opacity: 0;
    position: absolute;
}

.checkmark {
    position: absolute;
    top: 0;
    left: 0;
    width: 20px;
    height: 20px;
    background: var(--navy);
    border: 2px solid var(--navy-light);
    border-radius: 4px;
}

.checkbox-cell input:checked ~ .checkmark {
    background: var(--lime);
    border-color: var(--lime);
}

.checkbox-cell input:checked ~ .checkmark:after {
    content: '‚úì';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: var(--navy-dark);
    font-weight: bold;
}

.blog-title-cell {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.blog-thumbnail {
    width: 60px;
    height: 60px;
    border-radius: var(--radius-md);
    overflow: hidden;
    flex-shrink: 0;
}

.blog-thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.thumbnail-placeholder {
    width: 100%;
    height: 100%;
    background: var(--navy-light);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
    font-size: 1.5rem;
}

.blog-info {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

.blog-excerpt {
    color: var(--text-muted);
    font-size: 0.85rem;
}

.status-badge {
    display: inline-block;
    padding: 0.375rem 0.75rem;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 600;
}

.status-published { background: rgba(40, 167, 69, 0.1); color: #28a745; }
.status-draft { background: rgba(108, 117, 125, 0.1); color: #6c757d; }
.status-scheduled { background: rgba(255, 193, 7, 0.1); color: #ffc107; }

.action-buttons {
    display: flex;
    gap: 0.5rem;
}

.btn-action {
    width: 36px;
    height: 36px;
    border-radius: var(--radius-sm);
    border: 1px solid var(--navy-light);
    background: transparent;
    color: var(--text-light);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: var(--transition);
}

.btn-edit:hover { background: rgba(162, 210, 66, 0.1); color: var(--lime); }
.btn-delete:hover { background: rgba(220, 53, 69, 0.1); color: #dc3545; }
.btn-more:hover { background: var(--navy-light); }

.empty-table {
    text-align: center;
    padding: 4rem 2rem;
}

/* Bulk Actions */
.bulk-actions {
    display: none;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 1.5rem;
    background: rgba(162, 210, 66, 0.1);
    border: 1px solid var(--lime);
    border-radius: var(--radius-lg);
    margin-top: 1rem;
}

.bulk-info {
    color: var(--lime);
    font-weight: 500;
}

.bulk-buttons {
    display: flex;
    gap: 1rem;
}

.btn-danger {
    background: rgba(220, 53, 69, 0.1);
    color: #dc3545;
    border: 1px solid rgba(220, 53, 69, 0.3);
    padding: 0.75rem 1.5rem;
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: var(--transition);
}

.btn-danger:hover {
    background: #dc3545;
    color: white;
}

/* ====== Modals & Dropdowns ====== */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.8);
    z-index: 2000;
    justify-content: center;
    align-items: center;
    padding: 1rem;
}

.modal-content {
    background: var(--navy);
    border-radius: var(--radius-xl);
    border: 1px solid var(--navy-light);
    width: 100%;
    max-width: 800px;
    max-height: 90vh;
    overflow-y: auto;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.5rem 2rem;
    border-bottom: 1px solid var(--navy-light);
}

.modal-header h3 {
    color: var(--lime-light);
    margin: 0;
}

.modal-close {
    background: none;
    border: none;
    color: var(--text-muted);
    font-size: 2rem;
    cursor: pointer;
    padding: 0;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
}

.modal-close:hover {
    background: rgba(255, 255, 255, 0.1);
}

.modal-body {
    padding: 2rem;
}

.modal-footer {
    display: flex;
    justify-content: flex-end;
    gap: 1rem;
    padding: 1.5rem 2rem;
    border-top: 1px solid var(--navy-light);
}

.dropdown-menu {
    display: none;
    position: absolute;
    background: var(--navy);
    border: 1px solid var(--navy-light);
    border-radius: var(--radius-md);
    min-width: 200px;
    z-index: 1000;
    box-shadow: var(--shadow-lg);
}

.dropdown-menu button {
    display: block;
    width: 100%;
    padding: 0.75rem 1rem;
    background: none;
    border: none;
    text-align: left;
    color: var(--text-light);
    cursor: pointer;
    transition: var(--transition);
}

.dropdown-menu button:hover {
    background: var(--navy-light);
}

.dropdown-menu hr {
    border: none;
    height: 1px;
    background: var(--navy-light);
    margin: 0.5rem 0;
}

/* Toast */
.toast {
    display: none;
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    background: var(--navy);
    border: 1px solid var(--lime);
    border-radius: var(--radius-lg);
    padding: 1rem 1.5rem;
    display: flex;
    align-items: center;
    gap: 1rem;
    z-index: 3000;
    animation: slideInUp 0.3s ease;
}

.toast-icon {
    font-size: 1.5rem;
    color: var(--lime);
}

.toast-content {
    flex: 1;
    color: var(--text-light);
}

.toast-close {
    background: none;
    border: none;
    color: var(--text-muted);
    font-size: 1.5rem;
    cursor: pointer;
    padding: 0;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
}

.toast-close:hover {
    background: rgba(255, 255, 255, 0.1);
}

/* ====== Animations ====== */
@keyframes slideInRight {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

@keyframes slideInUp {
    from {
        transform: translateY(100%);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

/* ====== Responsive Design ====== */
@media (max-width: 1024px) {
    .admin-dashboard {
        padding: 1rem;
    }
    
    .main-content {
        grid-template-columns: 1fr;
    }
    
    .dashboard-header {
        padding: 1.5rem;
    }
    
    .header-main {
        flex-direction: column;
        gap: 1rem;
    }
    
    .stats-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (max-width: 768px) {
    .form-actions {
        flex-direction: column;
    }
    
    .btn-primary, .btn-secondary, .btn-outline {
        width: 100%;
    }
    
    .section-actions {
        flex-direction: column;
        align-items: stretch;
    }
    
    .search-box {
        width: 100%;
    }
    
    .actions-grid {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .blogs-table {
        font-size: 0.9rem;
    }
    
    .blog-title-cell {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
    }
}

@media (max-width: 480px) {
    .stats-grid {
        grid-template-columns: 1fr;
    }
    
    .actions-grid {
        grid-template-columns: 1fr;
    }
    
    .header-tabs {
        flex-wrap: wrap;
    }
    
    .tab-btn {
        flex: 1;
        text-align: center;
        min-width: 100px;
    }
}
</style>

<script>
// ====== Core Variables ======
let selectedBlogs = new Set();
let currentEditor = null;

// ====== DOM Content Loaded ======
document.addEventListener('DOMContentLoaded', function() {
    // Initialize character counters
    const titleInput = document.querySelector('input[name="title"]');
    const contentTextarea = document.querySelector('textarea[name="content"]');
    
    if (titleInput) {
        titleInput.addEventListener('input', updateLivePreview);
        updateCounter('titleCounter', titleInput, 100);
    }
    
    if (contentTextarea) {
        contentTextarea.addEventListener('input', updateLivePreview);
        updateCounter('contentCounter', contentTextarea, 5000);
    }
    
    // Initialize image uploader
    const imageUploader = document.getElementById('imageUploader');
    if (imageUploader) {
        imageUploader.addEventListener('dragover', handleDragOver);
        imageUploader.addEventListener('dragleave', handleDragLeave);
        imageUploader.addEventListener('drop', handleDrop);
    }
    
    // Initialize status radio buttons
    const statusRadios = document.querySelectorAll('input[name="status"]');
    statusRadios.forEach(radio => {
        radio.addEventListener('change', function() {
            const dateInput = document.querySelector('input[name="scheduled_date"]');
            if (this.value === 'scheduled') {
                dateInput.disabled = false;
                dateInput.required = true;
            } else {
                dateInput.disabled = true;
                dateInput.required = false;
            }
        });
    });
    
    // Initialize checkbox functionality
    const selectAll = document.getElementById('selectAll');
    if (selectAll) {
        selectAll.addEventListener('change', function() {
            const checkboxes = document.querySelectorAll('.blog-checkbox');
            checkboxes.forEach(checkbox => {
                checkbox.checked = this.checked;
                if (this.checked) {
                    selectedBlogs.add(checkbox.value);
                } else {
                    selectedBlogs.delete(checkbox.value);
                }
            });
            updateBulkActions();
        });
    }
    
    // Initialize individual checkboxes
    document.querySelectorAll('.blog-checkbox').forEach(checkbox => {
        checkbox.addEventListener('change', function() {
            if (this.checked) {
                selectedBlogs.add(this.value);
            } else {
                selectedBlogs.delete(this.value);
                document.getElementById('selectAll').checked = false;
            }
            updateBulkActions();
        });
    });
    
    // Auto-hide alerts after 5 seconds
    setTimeout(() => {
        const alerts = document.querySelectorAll('.alert');
        alerts.forEach(alert => {
            alert.style.transition = 'opacity 0.3s ease';
            alert.style.opacity = '0';
            setTimeout(() => alert.remove(), 300);
        });
    }, 5000);
});

// ====== Tab Navigation ======
function switchTab(tabName) {
    const tabs = document.querySelectorAll('.tab-btn');
    tabs.forEach(tab => tab.classList.remove('active'));
    event.target.classList.add('active');
    
    // Here you would load content for the selected tab
    showToast(`Switched to ${tabName} tab`);
}

// ====== Character Counter ======
function updateCounter(counterId, element, max) {
    const counter = document.getElementById(counterId);
    const count = element.value.length;
    counter.textContent = `${count}/${max}`;
    
    if (count > max * 0.9) {
        counter.style.color = '#dc3545';
    } else if (count > max * 0.75) {
        counter.style.color = '#ffc107';
    } else {
        counter.style.color = 'var(--text-muted)';
    }
}

// ====== Slug Generator ======
function generateSlug() {
    const title = document.querySelector('input[name="title"]').value;
    const slugField = document.getElementById('slugField');
    
    if (title) {
        let slug = title.toLowerCase()
            .replace(/[^\w\s-]/g, '')
            .replace(/[\s_-]+/g, '-')
            .replace(/^-+|-+$/g, '');
        
        slugField.value = slug;
        slugField.readOnly = false;
        showToast('Slug generated successfully');
    } else {
        showToast('Please enter a title first', 'error');
    }
}

// ====== Text Formatting ======
function formatText(command) {
    const textarea = document.getElementById('contentEditor');
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const selectedText = textarea.value.substring(start, end);
    
    let formattedText = selectedText;
    
    switch(command) {
        case 'bold':
            formattedText = `**${selectedText}**`;
            break;
        case 'italic':
            formattedText = `*${selectedText}*`;
            break;
        case 'underline':
            formattedText = `<u>${selectedText}</u>`;
            break;
        case 'link':
            formattedText = `[${selectedText}](https://example.com)`;
            break;
        case 'image':
            formattedText = `![${selectedText}](image-url)`;
            break;
        case 'code':
            formattedText = `\`${selectedText}\``;
            break;
        case 'h1':
            formattedText = `# ${selectedText}`;
            break;
        case 'h2':
            formattedText = `## ${selectedText}`;
            break;
        case 'h3':
            formattedText = `### ${selectedText}`;
            break;
    }
    
    textarea.value = textarea.value.substring(0, start) + formattedText + textarea.value.substring(end);
    updateLivePreview();
    showToast('Text formatted');
}

// ====== Image Upload & Preview ======
function handleImageUpload(event) {
    const file = event.target.files[0];
    if (!file) return;
    
    if (!file.type.match('image.*')) {
        showToast('Please select an image file', 'error');
        return;
    }
    
    if (file.size > 5 * 1024 * 1024) {
        showToast('Image size should be less than 5MB', 'error');
        return;
    }
    
    const reader = new FileReader();
    reader.onload = function(e) {
        const preview = document.getElementById('uploadedImage');
        const previewContainer = document.getElementById('imagePreview');
        
        preview.src = e.target.result;
        previewContainer.style.display = 'block';
        
        // Update live preview
        const previewImage = document.querySelector('#previewImage .image-placeholder');
        previewImage.innerHTML = `<img src="${e.target.result}" alt="Featured Image" style="width:100%;border-radius:8px;">`;
        
        showToast('Image uploaded successfully');
    };
    reader.readAsDataURL(file);
}

function handleDragOver(e) {
    e.preventDefault();
    e.stopPropagation();
    const uploader = document.getElementById('imageUploader');
    uploader.style.borderColor = 'var(--lime)';
    uploader.style.background = 'rgba(162, 210, 66, 0.1)';
}

function handleDragLeave(e) {
    e.preventDefault();
    e.stopPropagation();
    const uploader = document.getElementById('imageUploader');
    uploader.style.borderColor = 'var(--navy-light)';
    uploader.style.background = '';
}

function handleDrop(e) {
    e.preventDefault();
    e.stopPropagation();
    handleDragLeave(e);
    
    const files = e.dataTransfer.files;
    if (files.length > 0) {
        document.getElementById('imageInput').files = files;
        handleImageUpload({target: {files: files}});
    }
}

function removeImage() {
    document.getElementById('imageInput').value = '';
    document.getElementById('imagePreview').style.display = 'none';
    document.querySelector('#previewImage .image-placeholder').innerHTML = '<span>üì∑ Featured Image Preview</span>';
    showToast('Image removed');
}

// ====== Image Editor ======
function openImageEditor() {
    const image = document.getElementById('uploadedImage').src;
    if (!image) {
        showToast('No image to edit', 'error');
        return;
    }
    
    document.getElementById('editImage').src = image;
    document.getElementById('imageEditorModal').style.display = 'flex';
}

function applyImageEdits() {
    // This would normally involve canvas manipulation
    // For now, we'll just show a success message
    showToast('Image edits applied');
    closeModal('imageEditorModal');
}

// ====== Live Preview ======
function updateLivePreview() {
    const title = document.querySelector('input[name="title"]').value || 'Your Blog Title Here';
    const content = document.querySelector('textarea[name="content"]').value || 'Your blog content will appear here...';
    
    document.getElementById('previewTitle').textContent = title;
    document.getElementById('previewContent').innerHTML = marked.parse(content);
    
    // Update word count
    const wordCount = content.trim().split(/\s+/).length;
    document.querySelector('.preview-stats span:last-child').textContent = `üìù ${wordCount} words`;
}

function togglePreview() {
    const previewCard = document.querySelector('.preview-card');
    previewCard.style.display = previewCard.style.display === 'none' ? 'block' : 'none';
    showToast('Preview toggled');
}

function refreshPreview() {
    updateLivePreview();
    showToast('Preview refreshed');
}

function togglePreviewSize() {
    const preview = document.querySelector('.preview-container');
    preview.classList.toggle('full-size');
    showToast('Preview size toggled');
}

// ====== Save Draft ======
function saveDraft() {
    // This would normally save to localStorage or make an API call
    showToast('Draft saved successfully');
}

// ====== Search & Filter ======
function searchBlogs(query) {
    const rows = document.querySelectorAll('.blog-row');
    rows.forEach(row => {
        const title = row.querySelector('.blog-info strong').textContent.toLowerCase();
        const excerpt = row.querySelector('.blog-excerpt').textContent.toLowerCase();
        
        if (title.includes(query.toLowerCase()) || excerpt.includes(query.toLowerCase())) {
            row.style.display = '';
        } else {
            row.style.display = 'none';
        }
    });
}

function filterBlogs(status) {
    const rows = document.querySelectorAll('.blog-row');
    rows.forEach(row => {
        if (status === 'all' || row.dataset.status === status) {
            row.style.display = '';
        } else {
            row.style.display = 'none';
        }
    });
    showToast(`Filtered by: ${status}`);
}

// ====== Blog Actions ======
function deleteBlog(blogId) {
    if (confirm('Are you sure you want to delete this blog?')) {
        // This would normally make an API call
        document.querySelector(`form[action*="${blogId}"]`).submit();
    }
}

function showMoreActions(blogId) {
    const menu = document.getElementById('moreActionsMenu');
    menu.style.display = 'block';
    menu.style.top = `${event.target.getBoundingClientRect().bottom}px`;
    menu.style.left = `${event.target.getBoundingClientRect().left}px`;
    
    // Position adjustments
    if (menu.getBoundingClientRect().right > window.innerWidth) {
        menu.style.left = `${window.innerWidth - menu.offsetWidth - 10}px`;
    }
    
    // Close menu when clicking elsewhere
    setTimeout(() => {
        document.addEventListener('click', function closeMenu(e) {
            if (!menu.contains(e.target)) {
                menu.style.display = 'none';
                document.removeEventListener('click', closeMenu);
            }
        });
    });
}

// ====== Bulk Actions ======
function updateBulkActions() {
    const bulkActions = document.getElementById('bulkActions');
    const selectedCount = document.getElementById('selectedCount');
    
    selectedCount.textContent = selectedBlogs.size;
    
    if (selectedBlogs.size > 0) {
        bulkActions.style.display = 'flex';
    } else {
        bulkActions.style.display = 'none';
    }
}

function bulkPublish() {
    if (selectedBlogs.size === 0) return;
    
    if (confirm(`Publish ${selectedBlogs.size} selected blog(s)?`)) {
        // This would normally make an API call
        showToast(`${selectedBlogs.size} blog(s) published successfully`);
        selectedBlogs.clear();
        updateBulkActions();
    }
}

function bulkDraft() {
    if (selectedBlogs.size === 0) return;
    
    if (confirm(`Save ${selectedBlogs.size} selected blog(s) as draft?`)) {
        showToast(`${selectedBlogs.size} blog(s) saved as draft`);
        selectedBlogs.clear();
        updateBulkActions();
    }
}

function bulkDelete() {
    if (selectedBlogs.size === 0) return;
    
    if (confirm(`Delete ${selectedBlogs.size} selected blog(s)? This action cannot be undone.`)) {
        // This would normally make an API call
        showToast(`${selectedBlogs.size} blog(s) deleted successfully`);
        selectedBlogs.clear();
        updateBulkActions();
    }
}

// ====== Quick Actions ======
function exportContent() {
    showToast('Export feature coming soon');
}

function showAnalytics() {
    showToast('Analytics dashboard coming soon');
}

function manageUsers() {
    window.location.href = "{{ url_for('admin.users') }}";
}

function openSettings() {
    showToast('Settings panel coming soon');
}

function showHelp() {
    showToast('Help documentation coming soon');
}

// ====== Modal Functions ======
function closeModal(modalId) {
    document.getElementById(modalId).style.display = 'none';
}

// ====== Toast Notifications ======
function showToast(message, type = 'success') {
    const toast = document.getElementById('successToast');
    const toastMessage = document.getElementById('toastMessage');
    
    toastMessage.textContent = message;
    toast.className = 'toast';
    toast.classList.add(`toast-${type}`);
    toast.style.display = 'flex';
    
    setTimeout(() => {
        toast.style.opacity = '0';
        setTimeout(() => {
            toast.style.display = 'none';
            toast.style.opacity = '1';
        }, 300);
    }, 3000);
}

function hideToast() {
    const toast = document.getElementById('successToast');
    toast.style.display = 'none';
}

// ====== Collapsible Sections ======
function toggleCollapse(sectionId) {
    const section = document.getElementById(sectionId);
    const icon = event.target.querySelector('.collapse-icon');
    
    section.style.display = section.style.display === 'none' ? 'block' : 'none';
    icon.textContent = section.style.display === 'none' ? '‚ñ∂' : '‚ñº';
}

// ====== Form Validation ======
document.getElementById('createBlogForm').addEventListener('submit', function(e) {
    const title = this.querySelector('input[name="title"]').value.trim();
    const content = this.querySelector('textarea[name="content"]').value.trim();
    
    if (!title || !content) {
        e.preventDefault();
        showToast('Please fill in all required fields', 'error');
        return;
    }
    
    // Show loading state
    const submitBtn = this.querySelector('button[type="submit"]');
    const originalText = submitBtn.textContent;
    submitBtn.innerHTML = '<span class="btn-icon">‚è≥</span><span class="btn-text">Publishing...</span>';
    submitBtn.disabled = true;
    
    // Simulate upload time
    setTimeout(() => {
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
    }, 1500);
});

// ====== Markdown Parser (Simple) ======
window.marked = {
    parse: function(text) {
        return text
            .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
            .replace(/\*(.*?)\*/g, '<em>$1</em>')
            .replace(/`(.*?)`/g, '<code>$1</code>')
            .replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2" target="_blank">$1</a>')
            .replace(/\!\[(.*?)\]\((.*?)\)/g, '<img src="$2" alt="$1" style="max-width:100%;border-radius:8px;">')
            .replace(/^### (.*$)/gm, '<h3>$1</h3>')
            .replace(/^## (.*$)/gm, '<h2>$1</h2>')
            .replace(/^# (.*$)/gm, '<h1>$1</h1>')
            .replace(/\n/g, '<br>');
    }
};

// ====== Keyboard Shortcuts ======
document.addEventListener('keydown', function(e) {
    // Ctrl/Cmd + S to save draft
    if ((e.ctrlKey || e.metaKey) && e.key === 's') {
        e.preventDefault();
        saveDraft();
    }
    
    // Ctrl/Cmd + P to toggle preview
    if ((e.ctrlKey || e.metaKey) && e.key === 'p') {
        e.preventDefault();
        togglePreview();
    }
    
    // Escape to close modals
    if (e.key === 'Escape') {
        document.querySelectorAll('.modal').forEach(modal => {
            modal.style.display = 'none';
        });
        document.getElementById('moreActionsMenu').style.display = 'none';
    }
});

// ====== Auto-save Draft ======
let autoSaveInterval;
function startAutoSave() {
    if (autoSaveInterval) clearInterval(autoSaveInterval);
    autoSaveInterval = setInterval(saveDraft, 30000); // Every 30 seconds
}

function stopAutoSave() {
    if (autoSaveInterval) clearInterval(autoSaveInterval);
}

// Start auto-save when user starts typing
document.querySelectorAll('input, textarea').forEach(element => {
    element.addEventListener('input', function() {
        if (!autoSaveInterval) startAutoSave();
    });
});

// ====== Export Functions ======
function viewBlog() { showToast('Viewing blog'); }
function shareBlog() { showToast('Sharing blog'); }
function duplicateBlog() { showToast('Duplicating blog'); }
function exportBlog() { showToast('Exporting blog'); }
function viewAnalytics() { showToast('Viewing analytics'); }
function viewComments() { showToast('Viewing comments'); }
</script>
{% endblock %}